@inject NavigationManager NavManager
@inject IConfiguration Configuration
@inject ISyncLocalStorageService LocalStorage

@code {
    private string openWeatherApi;
    private string DriveApi;
    private string DriveFolder;

    protected override void OnInitialized()
    {
        var apiKey = LocalStorage.GetItem<string>(Constants.KeyApiKey);
        var uri = NavManager.ToAbsoluteUri(NavManager.BaseUri);

        if (string.IsNullOrEmpty(apiKey))
        {
            var configApiKey = Configuration.GetValue<string>("OpenWeather:ApiKey");

            if (string.IsNullOrEmpty(configApiKey))
            {
                NavManager.NavigateTo($"{uri}/apisettings");
            }

            LocalStorage.SetItem<string>(Constants.KeyApiKey, configApiKey);
        }

        var startPage = LocalStorage.GetItem<string>(Constants.StartPage) is null
        ? Constants.DefaultStartingPage
        : LocalStorage.GetItem<string>(Constants.StartPage);

        NavManager.NavigateTo($"{uri}/{startPage}");
    }
}

