@inject NavigationManager NavManager
@inject IConfiguration Configuration
@inject ISyncLocalStorageService LocalStorage

@code {
    private string _apiKey;


    protected override void OnInitialized()
    {
        _apiKey = LocalStorage.GetItem<string>(Constants.KeyApiKey);

        if (string.IsNullOrEmpty(_apiKey))
        {
            var configApiKey = Configuration.GetValue<string>("OpenWeather:ApiKey");

            if (!string.IsNullOrEmpty(configApiKey))
            {
                LocalStorage.SetItem<string>(Constants.KeyApiKey, configApiKey);
                _apiKey = configApiKey;
            }

        }

        if (string.IsNullOrEmpty(_apiKey))
        {
            NavManager.NavigateTo("/settings?showapikey=true");
        }
        else
        {
            NavManager.NavigateTo("/weather");
        }

    }

    protected override void OnAfterRender(bool firstRender)
    {

    }
}

